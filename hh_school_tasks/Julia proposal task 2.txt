Следует создать граф, описывающий всё поле.
(Как словарь, где ключи - координаты 1).

Потом обрабатывать этот графф, для вычисления вложенных участков.

