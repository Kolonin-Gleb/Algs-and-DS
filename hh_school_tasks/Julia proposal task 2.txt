Во второй проблема с вложенными участками.
Как идею могу предложить искать прямоугольники с периметром  из нулей ( перед этим огородив поле целиком нулями)
и размером 3х4 и больше и хранить координаты 
и площадь только для участка с наибольшей эффективностью.
Но надо еще подумать

